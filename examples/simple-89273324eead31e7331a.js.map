{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/eev/eev.js","webpack:///./src/devices/gamepad/controlMap.js","webpack:///./src/util/runProcessors.js","webpack:///./src/util/copyOptions.js","webpack:///./src/controls/InputControl.js","webpack:///./src/controls/AxisInputControl.js","webpack:///./src/controls/ButtonInputControl.js","webpack:///./src/controls/Vector2InputControl.js","webpack:///./src/processors/axisDeadZone.js","webpack:///./src/processors/stickDeadZone.js","webpack:///./src/controls/StickInputControl.js","webpack:///./src/devices/gamepad/index.js","webpack:///./src/controls/DPadComposite.js","webpack:///./src/controls/AxisComposite.js","webpack:///./src/interactions/Interaction.js","webpack:///./src/Action.js","webpack:///./src/interactions/PressInteraction.js","webpack:///./src/interactions/ReleaseInteraction.js","webpack:///./examples/simple.js","webpack:///./src/devices/keyboard/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","factory","define","Eev","id","splitter","LinkedList","linkConstructor","this","head","RunnableLink","tail","next","reg","prev","fn","noop","events","insert","data","link","remove","run","constructor","on","names","me","split","forEach","list","eev","_eev","off","undefined","emit","evt","amd","buttonIndexes","dpadUp","dpadDown","dpadLeft","dpadRight","L1","L2","L3","R1","R2","R3","A","B","X","Y","start","select","home","buttons","keys","sticks","reduce","runProcessors","processors","initialValue","copyOptions","dest","src","InputControl","read","options","Map","length","path","indexOf","k","substring","child","children","find","defaultValue","val","Math","abs","AxisInputControl","axis","ButtonInputControl","opts","magnitude","pressPoint","Vector2InputControl","vector2","x","parent","y","set","vec","hypot","axisDeadZone","min","max","absValue","sign","stickDeadZone","newMagnitude","scale","makeChild","negative","neg","rawAxisValue","mag","getChildValue","childbuttons","StickInputControl","standardControlNames","Set","add","readers","device","buttonIndex","leftAxisIndex","axes","axisIndex","Gamepad","index","updateFrequency","controlDefs","controlIndices","lastDevice","lastDeviceUpdate","update","navigator","getGamepads","timestamp","performance","now","buttonName","stickName","onConnected","gp","gamepad","onDisconnected","def","has","delete","getControl","ControlConstructor","Error","reader","controls","destroy","window","removeEventListener","defineProperties","connected","addEventListener","DPadInputControl","left","right","up","down","AxisComposite","positive","Interaction","binding","control","defaultInteraction","Action","bindings","interactions","interactionStack","destroyed","enabled","activeBinding","activeTime","state","transitionState","nextState","push","event","clearInteractions","interaction","reset","processInteraction","stackIndex","findIndex","iState","newState","process","unbind","splice","previousBinding","best","Infinity","controlValue","interactionBinding","interacted","shift","activeControl","apply","PressInteraction","ReleaseInteraction","pressed","wasPressed","leftStick","rightStickHoriz","kbd","keysDown","onKeyDown","toLowerCase","onKeyUp","readAnyKey","size","readSingleKey","readFilterKey","filter","readArrayKey","some","boolAsNum","Array","isArray","String","configurable","writable","kbdWASD","DPadComposite","rotateArrowKeys","moveAction","rotateAction","buttonAction","console","log","thing","document","createElement","style","position","width","height","backgroundColor","margin","body","appendChild","last","delta","dx","dy","dr","meh","transform","requestAnimationFrame"],"mappings":"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","file":"examples/simple-89273324eead31e7331a.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/game-input/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","\nvar Eev = (function () {\n  var id = 0;\n  var splitter = /[\\s,]+/g;\n\n  // A relatively generic LinkedList impl\n  function LinkedList(linkConstructor) {\n    this.head = new RunnableLink();\n    this.tail = new RunnableLink(this.head);\n    this.head.next = this.tail;\n    this.linkConstructor = linkConstructor;\n    this.reg = {};\n  }\n\n  LinkedList.prototype = {\n    insert: function (data) {\n      var link = new RunnableLink(this.tail.prev, this.tail, data);\n      link.next.prev = link.prev.next = link;\n      return link;\n    },\n\n    remove: function (link) {\n      link.prev.next = link.next;\n      link.next.prev = link.prev;\n    }\n  };\n\n  // A link in the linked list which allows\n  // for efficient execution of the callbacks\n  function RunnableLink(prev, next, fn) {\n    this.prev = prev;\n    this.next = next;\n    this.fn = fn || noop;\n  }\n\n  RunnableLink.prototype.run = function (data) {\n    this.fn(data);\n    this.next && this.next.run(data);\n  };\n\n  function noop () { }\n\n  function Eev () {\n    this.events = {};\n  }\n\n  Eev.prototype = {\n    constructor: Eev,\n\n    on: function (names, fn) {\n      var me = this;\n\n      names.split(splitter).forEach(function (name) {\n        var list = me.events[name] || (me.events[name] = new LinkedList());\n        var eev = fn._eev || (fn._eev = (++id));\n\n        list.reg[eev] || (list.reg[eev] = list.insert(fn));\n      });\n    },\n\n    off: function (names, fn) {\n      var me = this;\n      fn && names.split(splitter).forEach(function (name) {\n        var list = me.events[name];\n\n        if (!list) {\n          return;\n        }\n\n        var link = list.reg[fn._eev];\n\n        list.reg[fn._eev] = undefined;\n\n        list && link && list.remove(link);\n      });\n    },\n\n    emit: function (name, data) {\n      var evt = this.events[name];\n      evt && evt.head.run(data);\n    }\n  };\n\n  return Eev;\n}());\n\n// AMD/CommonJS support\n(function (root, factory) {\n  var define = root.define;\n\n  if (define && define.amd) {\n    define([], factory);\n  } else if (typeof module !== 'undefined' && module.exports) {\n    module.exports = factory();\n  }\n}(this, function () { return Eev; }));\n","const buttonIndexes = {\n\tdpadUp: 12,\n\tdpadDown: 13,\n\tdpadLeft: 14,\n\tdpadRight: 15,\n\tL1: 4,\n\tL2: 6,\n\tL3: 10,\n\tR1: 5,\n\tR2: 7,\n\tR3: 11,\n\tA: 0,\n\tB: 1,\n\tX: 2,\n\tY: 3,\n\tstart: 9,\n\tselect: 8,\n\thome: 16\n};\nconst buttons = [];\nObject.keys(buttonIndexes).forEach(key => {\n\tbuttons[buttonIndexes[key]] = key;\n});\n\nconst axes = [\n\t'leftStickX',\n\t'leftStickY',\n\t'rightStickX',\n\t'rightStickY'\n];\n\nconst sticks = [\n\t'leftStick',\n\t'rightStick'\n];\n\nexport {\n\tbuttons,\n\tbuttonIndexes,\n\taxes,\n\tsticks\n};\n","const reduce = (prev, fn) => fn(prev);\n\nexport default function runProcessors(processors, initialValue) {\n\treturn processors.reduce(reduce, initialValue);\n}\n","export default function copyOptions(dest, src) {\n\tif (!src) {\n\t\treturn;\n\t}\n\tObject.keys(dest).forEach(key => {\n\t\tif (key in src && typeof dest[key] !== 'function') {\n\t\t\tdest[key] = src[key];\n\t\t}\n\t});\n}\n\n","import runProcessors from '../util/runProcessors';\nimport copyOptions from '../util/copyOptions';\n\nexport default class InputControl {\n\tstatic defaultValue = 0;\n\n\tname = '';\n\tparent = null;\n\tchildren = new Map();\n\tdevice = null;\n\tprocessors = [];\n\n\tconstructor(read, options) {\n\t\tcopyOptions(this, options);\n\t\tthis.read = this.processors.length ?\n\t\t\t() => runProcessors(this.processors, read()) :\n\t\t\tread || this.read;\n\t}\n\n\tfind(path) {\n\t\tif (!path) {\n\t\t\treturn this;\n\t\t}\n\n\t\tconst i = path.indexOf('/');\n\t\tif (i > 0) {\n\t\t\tconst k = path.substring(0, i);\n\t\t\tconst child = this.children.get(k);\n\t\t\tif (child) {\n\t\t\t\treturn child.find(path.substring(k + 1));\n\t\t\t}\n\t\t}\n\n\t\treturn this.children.get(path) || null;\n\t}\n\n\tread() {\n\t\treturn this.prototype.defaultValue;\n\t}\n\n\tmagnitude(val = this.read()) {\n\t\treturn Math.abs(val);\n\t}\n}\n","import InputControl from './InputControl';\n\nexport default class AxisInputControl extends InputControl {\n\tconstructor(read = () => 0, options) {\n\t\tsuper(read, options);\n\t\tthis.axis = this.read;\n\t}\n}\n","import AxisInputControl from './AxisInputControl';\nimport copyOptions from '../util/copyOptions';\n\nexport default class ButtonInputControl extends AxisInputControl {\n\tpressPoint = 0.5;\n\tconstructor(read, opts) {\n\t\tsuper(read, opts);\n\t\tcopyOptions(this, opts);\n\t}\n\n\tpressed(value = this.magnitude()) {\n\t\treturn value >= this.pressPoint;\n\t}\n}\n","import InputControl from './InputControl';\nimport AxisInputControl from './AxisInputControl';\n\nexport default class Vector2InputControl extends InputControl {\n\tstatic defaultValue = [0, 0];\n\n\tconstructor(read, options) {\n\t\tsuper(read, options);\n\n\t\tthis.vector2 = this.read;\n\t\tthis.x = new AxisInputControl(() => this.read()[0], Object.assign({}, options && options.x, {\n\t\t\tparent: this\n\t\t}));\n\n\t\t// i don't know why this is negative, but it is\n\t\tthis.y = new AxisInputControl(() => this.read()[1], Object.assign({}, options && options.y, {\n\t\t\tparent: this\n\t\t}));\n\t\tthis.children.set('x', this.x);\n\t\tthis.children.set('y', this.x);\n\t}\n\n\tmagnitude(vec = this.read()) {\n\t\treturn Math.hypot(vec[0], vec[1]);\n\t}\n}\n","export default function axisDeadZone(value, min = 0.125, max = 0.925) {\n\tconst absValue = Math.abs(value);\n\tif (absValue < min) {\n\t\treturn 0;\n\t}\n\tif (absValue > max) {\n\t\treturn Math.sign(value);\n\t}\n\n\treturn Math.sign(value) * (absValue - min) / (max - min);\n}\n","import axisDeadZone from './axisDeadZone';\n\nexport default function stickDeadZone(value, min, max) {\n\tconst [x, y] = value;\n\tconst magnitude = Math.hypot(x, y);\n\tconst newMagnitude = axisDeadZone(magnitude, min, max);\n\n\tif (newMagnitude === 0) {\n\t\treturn [0, 0];\n\t}\n\n\tconst scale = newMagnitude / magnitude;\n\treturn [x * scale, y * scale];\n}\n","import Vector2InputControl from './Vector2InputControl';\nimport ButtonInputControl from './ButtonInputControl';\nimport stickDeadZone from '../processors/stickDeadZone';\n\nfunction getChildValue(read, axis, neg) {\n\tconst vec = read();\n\tconst rawAxisValue = vec[axis];\n\tconst mag = Math.abs(neg ? -rawAxisValue : rawAxisValue);\n\treturn Math.max(0, mag);\n}\n\nfunction makeChild(parent, name, axis, negative, options) {\n\tconst opts = Object.assign({}, options && options[name], {\n\t\tparent\n\t});\n\tparent[name] = new ButtonInputControl(() => getChildValue(axis, negative), opts);\n\n\tparent.children.set(name, parent[name]);\n}\n\nconst childbuttons = [\n\t['left', 0, true],\n\t['right', 0, false],\n\t['down', 1, true],\n\t['up', 1, false]\n];\n\nexport default class StickInputControl extends Vector2InputControl {\n\tconstructor(read, options) {\n\t\tsuper(read, Object.assign(\n\t\t\t{\n\t\t\t\tprocessors: [stickDeadZone]\n\t\t\t},\n\t\t\toptions\n\t\t));\n\n\t\tchildbuttons.forEach(([name, axis, negative]) => {\n\t\t\tmakeChild(this, name, axis, negative, options);\n\t\t});\n\t}\n}\n","import {\n\tbuttons,\n\tsticks\n} from './controlMap';\nimport ButtonInputControl from '../../controls/ButtonInputControl';\nimport StickInputControl from '../../controls/StickInputControl';\nimport AxisInputControl from '../../controls/AxisInputControl';\nimport eev from 'eev';\n\nconst standardControlNames = new Set(buttons);\nsticks.forEach(n => standardControlNames.add(n));\n\nconst readers = new Map([\n\t[ButtonInputControl, (device, buttonIndex) => device.buttons[buttonIndex].value],\n\t[StickInputControl, (device, leftAxisIndex) => [\n\t\tdevice.axes[leftAxisIndex],\n\t\t-device.axes[leftAxisIndex + 1]\n\t]],\n\t[AxisInputControl, (device, axisIndex) => device.axes[axisIndex]]\n]);\n\nexport default function Gamepad(index = 0, {\n\tupdateFrequency = 1000 / 120\n} = {}) {\n\teev.call(this);\n\n\tconst controlDefs = new Map();\n\tconst controlIndices = new Map();\n\tlet lastDevice = null;\n\tlet lastDeviceUpdate = 0;\n\n\tbuttons.forEach((buttonName, i) => {\n\t\tcontrolDefs.set(buttonName, ButtonInputControl);\n\t\tcontrolIndices.set(buttonName, i);\n\t});\n\n\tsticks.forEach((stickName, i) => {\n\t\tcontrolDefs.set(stickName, StickInputControl);\n\t\tcontrolIndices.set(stickName, i * 2);\n\t});\n\n\tfunction update() {\n\t\tconst device = navigator.getGamepads()[index];\n\t\tconst timestamp = device && device.timestamp || performance.now();\n\t\tif (device && timestamp - lastDeviceUpdate >= updateFrequency) {\n\t\t\tlastDevice = device;\n\t\t\tlastDeviceUpdate = timestamp;\n\t\t}\n\t}\n\n\tconst onConnected = evt => {\n\t\tconst gp = evt.gamepad;\n\t\tif (gp.index === index) {\n\t\t\tupdate();\n\n\t\t\t// set any additional buttons or axes\n\t\t\tfor (let i = buttons.length; i < gp.buttons.length; i++) {\n\t\t\t\tconst name = 'button' + i;\n\t\t\t\tcontrolDefs.set(name, ButtonInputControl);\n\t\t\t\tcontrolIndices.set(name, i);\n\t\t\t}\n\n\t\t\tfor (let i = 4; i < gp.axes.length; i++) {\n\t\t\t\tconst name = 'axis' + i;\n\t\t\t\tcontrolDefs.set(name, AxisInputControl);\n\t\t\t\tcontrolIndices.set(name, i);\n\t\t\t}\n\n\t\t\tthis.emit('connected');\n\t\t}\n\t};\n\n\tconst onDisconnected = evt => {\n\t\tconst gp = evt.gamepad;\n\t\tif (gp.index === index) {\n\t\t\t// remove any extra controls\n\t\t\tcontrolDefs.forEach((def, key) => {\n\t\t\t\tif (!standardControlNames.has(key)) {\n\t\t\t\t\tcontrolDefs.delete(key);\n\t\t\t\t\tcontrolIndices.delete(key);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.emit('disconnected');\n\t\t}\n\t};\n\n\tthis.getControl = (name, options) => {\n\t\tconst ControlConstructor = controlDefs.get(name);\n\t\tif (!ControlConstructor) {\n\t\t\tthrow new Error('Control not found');\n\t\t}\n\n\t\tconst reader = readers.get(ControlConstructor);\n\t\tconst index = controlIndices.get(name);\n\t\tconst read = () => {\n\t\t\tupdate();\n\t\t\treturn lastDevice ?\n\t\t\t\treader(lastDevice, index) :\n\t\t\t\tControlConstructor.defaultValue;\n\t\t};\n\n\t\treturn new ControlConstructor(read, Object.assign({\n\t\t\tname\n\t\t}, options, {\n\t\t\tdevice: this\n\t\t}));\n\t};\n\n\tthis.controls = () => controlDefs.keys();\n\n\tthis.destroy = () => {\n\t\t// todo: clean out event listeners\n\t\twindow.removeEventListener('gamepadconnected', onConnected);\n\t\twindow.removeEventListener('gamepaddisconnected', onDisconnected);\n\t};\n\n\tObject.defineProperties(this, {\n\t\tdevice: {\n\t\t\tget: () => lastDevice\n\t\t},\n\t\tid: {\n\t\t\tget: () => lastDevice && lastDevice.id || null\n\t\t},\n\t\tconnected: {\n\t\t\tget: () => !!lastDevice && lastDevice.connected\n\t\t},\n\t\ttimestamp: {\n\t\t\tget: () => lastDeviceUpdate\n\t\t}\n\t});\n\n\tupdate();\n\twindow.addEventListener('gamepadconnected', onConnected);\n\twindow.addEventListener('gamepaddisconnected', onDisconnected);\n}\n\nGamepad.prototype = Object.create(eev.prototype);\n","import Vector2InputControl from './Vector2InputControl';\n\nexport default class DPadInputControl extends Vector2InputControl {\n\tconstructor({\n\t\tleft,\n\t\tright,\n\t\tup,\n\t\tdown,\n\t\t...opts\n\t}) {\n\t\tconst read = () => {\n\t\t\tconst x = (right.read() - left.read()) / 2;\n\t\t\tconst y = (up.read() - down.read()) / 2;\n\t\t\treturn [x, y];\n\t\t};\n\t\tsuper(read, opts);\n\n\t\tthis.children.set('left', left);\n\t\tthis.children.set('right', right);\n\t\tthis.children.set('up', up);\n\t\tthis.children.set('down', down);\n\t}\n}\n","import AxisInputControl from './AxisInputControl';\nimport axisDeadZone from '../processors/axisDeadZone';\n\nexport default class AxisComposite extends AxisInputControl {\n\tconstructor({\n\t\tnegative,\n\t\tpositive,\n\t\t...opts\n\t}) {\n\t\tconst read = () => {\n\t\t\tconst neg = negative.read();\n\t\t\tconst pos = positive.read();\n\t\t\treturn (pos - neg) / 2;\n\t\t};\n\t\tsuper(read, Object.assign(\n\t\t\t{\n\t\t\t\tprocessors: [axisDeadZone]\n\t\t\t},\n\t\t\topts\n\t\t));\n\n\t\tthis.children.set('negative', negative);\n\t\tthis.children.set('positive', positive);\n\t}\n}\n","export default class Interaction {\n\tprocess(binding/*, action*/) {\n\t\treturn binding.control.magnitude() > 0 ? 'complete' : 'inactive';\n\t}\n\n\treset() {}\n}\n","import eev from 'eev';\nimport runProcessors from './util/runProcessors';\nimport InputControl from './controls/InputControl';\nimport Interaction from './interactions/Interaction';\n\n/*\ntodo: give everything ids so we can reference them later.\nprobably.\n*/\nconst defaultInteraction = new Interaction();\n\nexport default function Action(options = {}) {\n\teev.call(this);\n\tconst me = this;\n\n\tthis.name = options.name || '';\n\n\tconst bindings = [];\n\tconst processors = [];\n\tconst interactions = [];\n\tconst interactionStack = [];\n\n\tlet destroyed = false;\n\tlet enabled = true;\n\tlet activeBinding = null;\n\tlet activeTime = 0;\n\tlet state = 'inactive';\n\tlet value;\n\n\tthis.bindings = bindings;\n\tthis.processors = processors;\n\tthis.interactions = interactions;\n\n\t/*\n\tstates\n\t- inactive\n\t  - => active: started\n\t  - => complete: started, completed\n\t- active\n\t  - => complete: completed\n\t  - => inactive: canceled, ended\n\t- complete\n\t  - => inactive: ended\n\t*/\n\tconst transitionState = (nextState, binding) => {\n\t\tif (nextState === state || !enabled) { // todo: and binding hasn't changed\n\t\t\treturn;\n\t\t}\n\n\t\tif (nextState === 'active' && state === 'complete') {\n\t\t\t// stay right where we are\n\t\t\treturn;\n\t\t}\n\n\t\tconst events = [];\n\n\t\tif (nextState === 'complete') {\n\t\t\ttransitionState('active', binding);\n\t\t\tevents.push('completed');\n\t\t} else if (nextState === 'inactive') {\n\t\t\tif (state !== 'complete') {\n\t\t\t\tevents.push('canceled');\n\t\t\t}\n\t\t\tevents.push('ended');\n\t\t} else if (nextState === 'active') {\n\t\t\tevents.push('started');\n\t\t} else {\n\t\t\tthrow new Error('Unsupported state: ' + nextState);\n\t\t}\n\n\t\tstate = nextState;\n\t\tevents.forEach(event => this.emit(event, binding));\n\t};\n\n\tfunction clearInteractions() {\n\t\tinteractionStack.forEach(({ interaction }) => interaction.reset());\n\t\tinteractionStack.length = 0;\n\t}\n\n\tfunction processInteraction(binding, interaction) {\n\t\tlet stackIndex = interactionStack.findIndex(\n\t\t\tiState => iState.binding === binding && iState.interaction === interaction\n\t\t);\n\t\tlet iState = stackIndex >= 0 && interactionStack[stackIndex];\n\n\t\tconst newState = interaction.process(binding, me) ||\n\t\t\tiState && iState.state ||\n\t\t\t'inactive';\n\n\t\tif (stackIndex < 0 && newState !== 'inactive') {\n\t\t\tstackIndex = interactionStack.length;\n\t\t\tiState = {\n\t\t\t\tbinding,\n\t\t\t\tinteraction,\n\t\t\t\tstate: 'inactive'\n\t\t\t};\n\t\t\tinteractionStack.push(iState);\n\t\t}\n\t\tif (iState) {\n\t\t\tiState.state = newState;\n\t\t}\n\t}\n\n\t/*\n\ttodo: we need better CRUD methods for bindings, processors and interactions\n\t*/\n\tthis.bind = (control, options) => {\n\t\tif (!options && !(control instanceof InputControl)) {\n\t\t\toptions = control;\n\t\t}\n\t\tif (options && options.control) {\n\t\t\tcontrol = options.control;\n\t\t}\n\n\t\tif (!(control instanceof InputControl)) {\n\t\t\t// could we do this by duck-typing?\n\t\t\tthrow new Error('Binding requires an InputControl');\n\t\t}\n\n\t\tconst binding = {\n\t\t\tcontrol,\n\t\t\tprocessors: options && options.processors,\n\t\t\tinteractions: options && options.interactions\n\t\t};\n\t\tbindings.push(binding);\n\t\treturn bindings.length - 1;\n\t};\n\n\tthis.unbind = index => {\n\t\tif (index < bindings.length) {\n\t\t\tconst binding = bindings.splice(index, 1);\n\t\t\tif (binding === activeBinding) {\n\t\t\t\t// todo: reset state\n\t\t\t}\n\n\t\t\t// todo: clear binding from queue\n\t\t}\n\t};\n\n\tthis.update = () => {\n\t\tif (!enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst previousBinding = activeBinding;\n\t\tactiveBinding = null;\n\n\t\tlet best = -Infinity;\n\t\tfor (let i = 0; i < bindings.length; i++) {\n\t\t\tconst binding = bindings[i];\n\t\t\tconst { control } = binding;\n\t\t\tconst controlValue = control.read();\n\t\t\tconst magnitude = control.magnitude(controlValue);\n\t\t\tif (magnitude > best) {\n\t\t\t\tvalue = controlValue;\n\t\t\t\tbest = magnitude;\n\t\t\t\tif (magnitude > 0) {\n\t\t\t\t\tactiveBinding = binding;\n\t\t\t\t\tif (!activeTime) {\n\t\t\t\t\t\tactiveTime = performance.now();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!activeBinding) {\n\t\t\tactiveTime = 0;\n\t\t}\n\n\t\t// should processor happen before disambiguation?\n\t\tif (value !== undefined) {\n\t\t\tvalue = runProcessors(processors, value);\n\t\t}\n\n\t\t// interactions, events\n\t\tconst interactionBinding = activeBinding || previousBinding;\n\t\tlet interacted = interactions.length > 0;\n\t\tif (interactionBinding && interactionBinding.interactions) {\n\t\t\tinteracted = interacted || interactionBinding.interactions.length > 0;\n\t\t\tinteractionBinding.interactions.forEach(\n\t\t\t\tinteraction => processInteraction(interactionBinding, interaction)\n\t\t\t);\n\t\t}\n\n\t\t// todo: this will not catch deactivated controls that need to be processed\n\t\t// we need to re-think this whole flow\n\t\tif (interactionBinding) {\n\t\t\tinteractions.forEach(\n\t\t\t\tinteraction => processInteraction(interactionBinding, interaction)\n\t\t\t);\n\t\t}\n\n\t\tif (interactionBinding && !interacted) {\n\t\t\tprocessInteraction(interactionBinding, defaultInteraction);\n\t\t}\n\n\t\twhile (interactionStack.length) {\n\t\t\tconst iState = interactionStack[0];\n\t\t\tif (iState.state === 'inactive') {\n\t\t\t\tinteractionStack.shift();\n\t\t\t\tiState.interaction.reset();\n\t\t\t\ttransitionState(iState.state, iState.binding);\n\t\t\t} else {\n\t\t\t\tif (iState.state === 'complete') {\n\t\t\t\t\tclearInteractions();\n\t\t\t\t\ttransitionState('complete', iState.binding);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!interactionStack.length) {\n\t\t\t// resetInteractions();\n\t\t\ttransitionState('inactive');\n\t\t}\n\t};\n\n\tthis.destroy = () => {\n\t\tdestroyed = true;\n\t\tenabled = false;\n\t\tclearInteractions();\n\t\ttransitionState('inactive');\n\t\tstate = 'destroyed';\n\t};\n\n\tObject.defineProperties(this, {\n\t\tenabled: {\n\t\t\tset(val) {\n\t\t\t\tval = !!val;\n\t\t\t\tif (val !== enabled && !destroyed) {\n\t\t\t\t\tenabled = val;\n\t\t\t\t\ttransitionState('inactive');\n\t\t\t\t\tstate = enabled ? 'inactive' : 'disabled';\n\t\t\t\t\tclearInteractions();\n\t\t\t\t}\n\t\t\t},\n\t\t\tget: () => enabled\n\t\t},\n\t\tactiveControl: {\n\t\t\tget: () => activeBinding && activeBinding.control\n\t\t},\n\t\tstate: {\n\t\t\tget: () => state\n\t\t},\n\t\tvalue: {\n\t\t\tget: () => value\n\t\t}\n\t});\n\n\tif (options.bindings) {\n\t\toptions.bindings.forEach(binding => {\n\t\t\tthis.bind(binding);\n\t\t});\n\t}\n\n\tif (options.processors) {\n\t\tprocessors.push.apply(processors, options.processors);\n\t}\n\n\tif (options.interactions) {\n\t\tinteractions.push.apply(interactions, options.interactions);\n\t}\n\n\tif (!options.enabled === false) {\n\t\tthis.enabled = false;\n\t}\n}\n\nAction.prototype = Object.create(eev.prototype);\n","import Interaction from './Interaction';\nexport default class PressInteraction extends Interaction {\n\tpressPoint = 0.5;\n\n\tconstructor(pressPoint) {\n\t\tsuper();\n\n\t\tif (pressPoint >= 0) {\n\t\t\tthis.pressPoint = pressPoint;\n\t\t}\n\t}\n\n\tprocess(binding/*, action*/) {\n\t\treturn binding.control.magnitude() > this.pressPoint ?\n\t\t\t'complete' :\n\t\t\t'inactive';\n\t}\n}\n","import Interaction from './Interaction';\nexport default function ReleaseInteraction(pressPoint = 0.5) {\n\tInteraction.call(this);\n\tthis.pressPoint = pressPoint;\n\n\tlet pressed = false;\n\n\tthis.update = binding => {\n\t\tconst wasPressed = pressed;\n\t\tpressed = binding.control.magnitude() > this.pressPoint;\n\n\t\tif (pressed) {\n\t\t\treturn 'active';\n\t\t}\n\n\t\tif (wasPressed) {\n\t\t\treturn 'complete';\n\t\t}\n\n\t\treturn '';\n\t};\n\n\tthis.reset = () => {\n\t\tpressed = false;\n\t};\n}\n\nReleaseInteraction.prototype = Object.create(Interaction.prototype);\n","import Gamepad from '../src/devices/gamepad';\nimport Keyboard from '../src/devices/keyboard';\nimport DPadComposite from '../src/controls/DPadComposite';\nimport AxisComposite from '../src/controls/AxisComposite';\nimport Action from '../src/Action';\nimport PressInteraction from '../src/interactions/PressInteraction';\nimport ReleaseInteraction from '../src/interactions/ReleaseInteraction';\n\nconst gamepad = new Gamepad();\nconst leftStick = gamepad.getControl('leftStick');\n// const downButton = leftStick.find('down');\nconst rightStickHoriz = gamepad.getControl('rightStick').find('x');\n\nconst kbd = new Keyboard();\nconst kbdWASD = new DPadComposite({\n\tup: kbd.getControl('W'),\n\tleft: kbd.getControl('A'),\n\tdown: kbd.getControl('S'),\n\tright: kbd.getControl('D')\n});\n\nconst rotateArrowKeys = new AxisComposite({\n\tnegative: kbd.getControl('arrowleft'),\n\tpositive: kbd.getControl('arrowright')\n});\n\nconst moveAction = new Action({\n\tbindings: [leftStick, kbdWASD]\n});\nconst rotateAction = new Action({\n\tbindings: [rightStickHoriz, rotateArrowKeys]\n});\n\nconst buttonAction = new Action({\n\tbindings: [kbd.getControl(' ')],\n\tinteractions: [\n\t\tnew PressInteraction(),\n\t\tnew ReleaseInteraction()\n\t]\n});\n// buttonAction.on('press', () => console.log('spacebar down'));\n// buttonAction.on('release', () => console.log('spacebar up'));\nbuttonAction.on('completed', binding => console.log('interaction', binding));\n\nconst thing = document.createElement('div');\nObject.assign(thing.style, {\n\tposition: 'absolute',\n\twidth: '30px',\n\theight: '60px',\n\tbackgroundColor: 'rebeccapurple',\n\tmargin: '-15px 30px'\n});\ndocument.body.appendChild(thing);\n\nconst speed = 300 / 1000; // pixels per 1000ms\nconst rotSpeed = 360 / 1000; // degrees per 1000ms\nlet x = 100;\nlet y = 100;\nlet r = 30;\n\nlet last = performance.now();\nfunction update(t = performance.now()) {\n\tconst delta = t - last;\n\tlast = t;\n\n\tmoveAction.update();\n\trotateAction.update();\n\tbuttonAction.update();\n\n\tconst [dx, dy] = moveAction.value;\n\tconst dr = rotateAction.value;\n\n\tconst meh = speed * delta;\n\tx += dx * meh;\n\ty -= dy * meh;\n\n\tr += dr * rotSpeed * delta;\n\n\t// render\n\tthing.style.transform = `translate(${x}px, ${y}px) rotate(${r}deg)`;\n\trequestAnimationFrame(update);\n}\n\nupdate();\n","import ButtonInputControl from '../../controls/ButtonInputControl';\n\nexport default function Keyboard() {\n\tconst keysDown = new Set();\n\n\tconst onKeyDown = evt => {\n\t\tkeysDown.add(evt.key.toLowerCase());\n\t};\n\tconst onKeyUp = evt => {\n\t\tkeysDown.delete(evt.key.toLowerCase());\n\t};\n\n\tfunction readAnyKey() {\n\t\treturn keysDown.size > 0;\n\t}\n\n\tfunction readSingleKey(key) {\n\t\treturn keysDown.has(key.toLowerCase());\n\t}\n\n\tfunction readFilterKey(filter) {\n\t\treturn readAnyKey() && filter(new Set(keysDown));\n\t}\n\n\tfunction readArrayKey(keys) {\n\t\treturn keys.some(readSingleKey);\n\t}\n\n\tconst boolAsNum = fn => () => fn() ? 1 : 0;\n\n\tthis.getControl = (name, options = {}) => {\n\t\tconst {\n\t\t\tfilter = name,\n\t\t\t...opts\n\t\t} = options;\n\n\t\tlet read = readAnyKey;\n\t\tif (filter) {\n\t\t\tif (typeof filter === 'string') {\n\t\t\t\tread = () => readSingleKey(filter);\n\t\t\t} else if (typeof filter === 'function') {\n\t\t\t\tread = () => readFilterKey(filter);\n\t\t\t} else if (Array.isArray(filter)) {\n\t\t\t\tread = () => readArrayKey(filter);\n\t\t\t}\n\t\t}\n\n\t\treturn new ButtonInputControl(boolAsNum(read), Object.assign({\n\t\t\tname: typeof name === 'string' && options.filter ?\n\t\t\t\tname :\n\t\t\t\ttypeof filter === 'string' ?\n\t\t\t\t\t`key:${filter}` :\n\t\t\t\t\tString(name || filter)\n\t\t}, opts));\n\t};\n\n\tthis.destroy = () => {\n\t\twindow.removeEventListener('keydown', onKeyDown);\n\t\twindow.removeEventListener('keyup', onKeyUp);\n\t};\n\n\t// assume keyboard is always connected\n\tObject.defineProperty(this, 'connected', {\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t\twritable: false,\n\t\tvalue: true\n\t});\n\n\twindow.addEventListener('keydown', onKeyDown);\n\twindow.addEventListener('keyup', onKeyUp);\n}\n"],"sourceRoot":""}